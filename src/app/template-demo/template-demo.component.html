<div class="page-wrapper">
  <div class="container py-5">
    <div class="row justify-content-center">
      <div class="col-lg-5">
        <div class="form-card">

          <form #myForm="ngForm" (ngSubmit)="onSubmit(myForm)" novalidate>

            <!-- Username -->
            <div class="mb-3">
              <input
                class="form-control"
                [class.is-invalid]="username_field.touched && username_field.invalid"
                [class.is-valid]="username_field.touched && username_field.valid"
                type="text"
                name="username"
                [(ngModel)]="username"
                #username_field="ngModel"
                placeholder="Enter username"
                required
                minlength="3"
                maxlength="20"
                pattern="[a-zA-Z0-9_]+"
              />
              <div class="invalid-feedback" *ngIf="username_field.touched && username_field.errors">
                <span *ngIf="username_field.errors?.['required']">Username is required.</span>
                <span *ngIf="username_field.errors?.['minlength']">At least 3 characters required.</span>
                <span *ngIf="username_field.errors?.['pattern']">Only letters, numbers, and underscores.</span>
              </div>
            </div>

            <!-- Email -->
            <div class="mb-3">
              <input
                class="form-control"
                [class.is-invalid]="email_field.touched && email_field.invalid"
                [class.is-valid]="email_field.touched && email_field.valid"
                type="email"
                name="email"
                [(ngModel)]="email"
                #email_field="ngModel"
                placeholder="Enter email"
                required
                email
              />
              <div class="invalid-feedback" *ngIf="email_field.touched && email_field.errors">
                <span *ngIf="email_field.errors?.['required']">Email is required.</span>
                <span *ngIf="email_field.errors?.['email']">Enter a valid email address.</span>
              </div>
            </div>

            <!-- Password -->
            <div class="mb-3">
              <input
                class="form-control"
                [class.is-invalid]="password_field.touched && password_field.invalid"
                [class.is-valid]="password_field.touched && password_field.valid"
                type="password"
                name="password"
                [(ngModel)]="password"
                #password_field="ngModel"
                placeholder="Enter password"
                required
                minlength="8"
                pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).+$"
              />
              <div class="invalid-feedback" *ngIf="password_field.touched && password_field.errors">
                <span *ngIf="password_field.errors?.['required']">Password is required.</span>
                <span *ngIf="password_field.errors?.['minlength']">Minimum 8 characters.</span>
                <span *ngIf="password_field.errors?.['pattern']">Must include upper, lower, and number.</span>
              </div>
            </div>

            <!-- Role -->
            <div class="mb-3">
              <select
                class="form-select"
                [class.is-invalid]="role_field.touched && role_field.invalid"
                [class.is-valid]="role_field.touched && role_field.valid"
                name="role"
                [(ngModel)]="role"
                #role_field="ngModel"
                required
              >
                <option value="" disabled selected>Select role</option>
                <option value="Admin">Admin</option>
                <option value="User">User</option>
                <option value="Guest">Guest</option>
              </select>
              <div class="invalid-feedback" *ngIf="role_field.touched && role_field.errors">
                Please select a role.
              </div>
            </div>

            <!-- Gender (Radio Buttons) -->
            <div class="mb-3">
              <label class="form-label fw-semibold">Gender</label>
              <div class="d-flex gap-3">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="gender"
                    [(ngModel)]="gender"
                    #gender_field="ngModel"
                    value="Male"
                    id="genderMale"
                    required
                  />
                  <label class="form-check-label" for="genderMale">Male</label>
                </div>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="gender"
                    [(ngModel)]="gender"
                    value="Female"
                    id="genderFemale"
                  />
                  <label class="form-check-label" for="genderFemale">Female</label>
                </div>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="gender"
                    [(ngModel)]="gender"
                    value="Other"
                    id="genderOther"
                  />
                  <label class="form-check-label" for="genderOther">Other</label>
                </div>
              </div>
              <div class="text-danger small mt-1" *ngIf="submitted && !gender">
                Please select a gender.
              </div>
            </div>

            <!-- Status -->
            <div class="mb-3">
              <select
                class="form-select"
                [class.is-invalid]="status_field.touched && status_field.invalid"
                [class.is-valid]="status_field.touched && status_field.valid"
                name="status"
                [(ngModel)]="status"
                #status_field="ngModel"
                required
              >
                <option value="" disabled selected>Select status</option>
                <option value="Permanent">Permanent</option>
                <option value="Probationary">Probationary</option>
              </select>
              <div class="invalid-feedback" *ngIf="status_field.touched && status_field.errors">
                Please select a status.
              </div>
            </div>

            <!-- Comments / Notes -->
            <div class="mb-3">
              <textarea
                class="form-control"
                name="comments"
                [(ngModel)]="comments"
                #comments_field="ngModel"
                placeholder="Comments / Notes"
                rows="3"
                maxlength="300"
              ></textarea>
              <div class="form-text text-end">{{ comments?.length || 0 }}/300</div>
            </div>

            <!-- Submit -->
            <div class="d-grid mt-2">
              <button type="submit" class="btn btn-primary" [disabled]="myForm.invalid">
                Submit
              </button>
            </div>

          </form>

          <!-- Success Output -->
          <div class="alert alert-success mt-4" *ngIf="submittedData">
            <h6 class="fw-bold">Form Submitted Successfully!</h6>
            <table class="table table-sm mt-2 mb-0">
              <tbody>
                <tr *ngFor="let key of objectKeys(submittedData)">
                  <td class="fw-semibold text-capitalize">{{ key }}</td>
                  <td>{{ submittedData[key] }}</td>
                </tr>
              </tbody>
            </table>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>